### Git学习

------

#### 一、git安装

+ 浏览器搜索git

<img src="C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118175617386.png" alt="image-20241118175617386" style="zoom:200%;" />

+ 进入后下载

  ![image-20241118175922993](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118175922993.png)

+ 下载选择

  git自带的客户端控制工具使用比较复杂，且界面不太友好，因此在下载git时可以选择git官网提供的客户端

  ![image-20241118180554369](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118180554369.png)

#### 二、界面介绍

![image-20241118184443665](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118184443665.png)

+ 克隆clone（镜像）

  git作为分布式版本控制软件，其资源是存放在中央服务器中，当客户端需要使用时，可以将资源拉取到本地服务器，以便于访问修改，且可以更安全的保存数据，当数据修改完成上传时，服务器会比对服务器内容与上传内容，做记录

  ![image-20241118184857824](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118184857824.png)

+ 创建本地仓库

  该选项用于创建本地仓库，平时自己写的一些代码及资源可以创建自己的本地仓库，上传至服务器

  ![image-20241118184953166](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118184953166.png)

+ 添加本地仓库

  若本地已经有仓库，可以通过该选项将该文件夹导入至当前工具中

  ![image-20241118185159617](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118185159617.png)

+ File介绍

  + option中的Git

    用于设置操作本地仓库时，是那个用户在操作仓库，方便对文件上传时的用户署名，以及责任追究（![06115840](C:\Users\27120\AppData\Local\Temp\SGPicFaceTpBq\13320\06115840.png))

    ![image-20241118185440941](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118185440941.png)

#### 三、创建第一个仓库

+ 填写基本属性
  + name：仓库名
  + Description：基本描述
  + Local path：选择本地仓库存放位置
  + Initiative this respository with a README：添加README文件
  + Git ingore：设置在提交时应当被忽略掉的本地配置文件与一些副本文件，其在提交时不会被本地仓库识别到修改
  + License：

+ 仓库文件创建

  在了解仓库文件创建之前需要明确一个问题，仓库到底是哪个部分，文件夹中.git文件夹才是仓库，也就是本地资源库（存储文件），而其他文件是我们的本地文件。

  git桌面程序并没有直接操作文件的功能，其工作原理为当用户对本地文件进行修改时，该程序会通过比对.git仓库的文件与本地文件，将修改的文件标记出来，并呈现在Changes中，该区域呈现的是可以提交仓库进行更新的文件。

  且文件在提交更新时，需要填写提交的概要与描述，更新仓库后，该改变就会消失

#### 四、多人协作开发

+ 分支概念及存在意义

  在[版本控制系统](https://so.csdn.net/so/search?q=版本控制系统&spm=1001.2101.3001.7020)（如Git）中，分支（Branch）是代码库的不同线路或路径，用于同时进行不同的开发工作。分支可以将代码库的状态 ‘‘复制’’ 到一个独立的环境中，使得在这个分支上进行的更改不会影响到其他分支。

  在实际多人开发中，当多个用户对同一对文件同时进行操作时，需要处理冲突，若频繁的出现冲突或提交时，将会对资源库产生很大负担；在大型应用开发时，通常会将任务作为多个模块分别开发，每人负责一个模块或多个模块，此时会降低多个用户操作同一文件的风险，但由于频繁提交会导致版本回退查询困难，出现其他问题

  分支：**基于主支创建出来的一个"副本"(不是简单复制)，在分支上修改的内容不会直接影响主支，且各个分支的内容相互独立。在分支上更新调试好后在将分支与主支合并，完成更新。分支只存放修改和更新的内容，而与主支一样的内容会直接引用。**

  在 Git 中，创建分支并不是将代码库的完整副本复制一份，而只是创建了一个指向特定提交（commit）的指针。实际上，在创建分支时，Git 仅仅创建了一个新的指针，该指针指向当前所在分支的最后一个提交（commit）。这样，新分支就可以独立地进行新增、修改和删除文件操作，而不会影响其他分支。由于 Git 使用的是基于快照（snapshot）的版本控制系统，每次提交（commit）都会记录项目的状态，因此创建新的分支并不需要复制整个代码库的副本。分支间共享大部分历史提交（commits），只有新分支上的更改会产生新的提交记录。因此，通过创建分支，您实际上是在给定的提交（commit）上创建了一个新的指针。这使得在不同的分支之间进行切换、合并和处理独立的开发任务变得非常高效和灵活。

+ 分支的创建

  在下述界面中，main就是主支，且用户可以通过New branch创建新的分支，进行不同的操作，主支可以通过最下方的合并将不同分支上的修改合并至主线中，当出现冲突时，需要将同一文件上的分支处理完毕后才能合并项目至主支中。在合并后通常需要再history中查看合并的操作，右键为其创建一个标签（create a tag），方便查看其操作的具体信息，以便于后续版本回退。

  ![image-20241118210259638](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118210259638.png)

  ![image-20241118210522986](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118210522986.png)

#### 五、远程项目拉取与提交

+ 项目拉取

  仓库分为本地仓库与远程仓库，远程仓库是指我们在github.com上自己创建的项目地址，当在本地电脑中登录github账号后，可以通过file下Clone a repository选择要克隆的远程仓库，将其拉取至本地仓库进行日常开发，在每次工作结束后，将项目中的更新与冲突解决，提交至主分支后

+ 项目提交

  当在git桌面程序从github远程仓库中，将仓库clone至本地后，本地对文件进行修改处理冲突后，更新本地仓库，在push origin中会出现提示，可以将本地仓库的更新推送至远程仓库

![image-20241118212524614](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241118212524614.png)





### Git命令

#### 一、本地初始化

+ 设置用户签名

  > 签名的作用就是用于表示用户，以区分不同的开发人员，--global代表以后在本电脑中使用git时的签名全都使用以下设置

  ```tex
  以下命令相当于git界面中，设置option中的个人信息
  git config --global user.email "2712054143@qq.com"
  git config --global user.name "白榆"
  ```

  ![image-20241119134141452](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119134141452.png)

+ 查看本地签名

  在git命令框中输入 **git config --global --list** 查看全局设置清单

  ![image-20241119134825530](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119134825530.png)

+ 初始化本地仓库

  > 当我们希望一个文件夹被git管理的话，那么就要在一个文件夹下进行git初始化，这个操作与桌面程序中创建第一个仓库类似，当对一个文件夹进行git初始化之后，生成的.git隐藏文件才是本地仓库，文件夹中的其他文件是自己创建的本地文件，当本地文件修改后，git会比对.git本地仓库与本地文件，找出修改的文件，进行本地仓库的提交（这个过程需要自行操作）

  1、找到一个希望被git管理的文件夹

  2、在文件夹中右键点开Git Bash Here

  3、输入指令git init

  > 此时文件夹内就会多出一个.git文件夹，这时这个文件夹就会被git管理了。只有当一个文件夹被git管理后，才可以使用git的功能做版本管理。也就是说，我们必须要把我们电脑中的某个文件夹授权给git，git才能对这个文件夹中的内容进行各种操作，而git init 就是在进行授权的操作



#### 二、Git工作机制

+ 工作区与版本库

  一个被git管理的文件夹中，除了自动生成的.git文件夹不属于工作区，其他的都属于工作区，用于修改自己的代码。

  .git文件夹则被称为版本库

+ 暂存区与分支

  暂存区是Git中的一个重要概念，位于工作目录和分支之间。当你在工作目录中修改了文件后，需要通过`git add`命令将这些修改添加到暂存区中。暂存区相当于一个缓冲区，存储了你将要提交的文件的快照，你可以在提交之前对暂存区进行任意次的修改，从而将多个修改打包成一次提交‌。

  简而言之就是，为了防止工作区对于分支的多次提交产生多条提交记录，导致查看记录的臃肿，Git提出了暂存区的概念，将编写好的代码先保存至暂存区，当确认工作完成后，将多次暂存的文件打包产生一条副分支提交，方便版本回撤，且当代码出现问题时，可以从分支撤回一条提交至暂存区，修改后在覆盖撤回的提交

  

#### 三、将文件添加至暂存区

+ 添加指定文件

  ```shell
  # 把文件夹下的index.txt 添加至暂存区
  $ git add index.txt
  ```

+ 把单独一个文件夹放在暂存区（暂存区不能存放空文件夹）

  ```shell
  # 把文件夹下的test文件夹放入暂存区
  $ git add test/
  ```

+ 将所有文件放入暂存区

  ```shell
  # 将工作区所有文件全部放入暂存区
  $ git add .
  ```

+ 查看git状态

  ```shell
  # 查看当前git分支，提交记录，以及暂存区文件（绿色为已经在暂存区文件）
  $ git status
  ```

  ![image-20241119144703589](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119144703589.png)

+ 删除暂存区指定文件

  ```shell
  # 删除暂存区指定文件
  $ git rm --cached 文件名
  ```

  ![image-20241119145116918](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119145116918.png)

#### 四、暂存区文件提交至本地库

+ 将暂存区文件提交至当前分支git commit

  ```shell
  # 将暂存区内容放在当前分支 -m添加描述
  $ git commit -m "附带提交信息"
  # 提交后的一行为           分支 版本号开头 提交描述
  # 在提交过程中，如果未添加提交信息，git会自动跳转至类似linux的文件操作模式，点击i进入insert模式，在不是#号开
  头的行中添加描述信息后，按ESC退至命令模式，输入：wq退出并保存文件
  ```

  ![image-20241119145646672](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119145646672.png)

+ 查看提交历史 git log

  ```shell
  # 查看历史提交记录  commit后跟的是版本号，最后一行为提交描述
  $ git log
  ```

  ![image-20241119150309465](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241119150309465.png)



#### 五、版本穿梭

+ 版本回退

  在将版本回退之前需要明白一个理念，git log中打印的第一行中  HEAD -> master，表示的是指向的是master分支，也就是所若此时版本回退，回退的是master分支上的版本，且版本回退并不意味着版本消失，只是由当前版本转移至其他版本

  ```shell
  # 回退head指针指向的分支  （一个^为）上一个版本
  $ git reset --hard HEAD^
  
  # 回退head指针指向分支的上上个版本(两个^^)
  $ git reset --hard HEAD^^
  # 另一种写法
  $ git reset --hard HEAD~2
  
  # 跳转至给定版本号的版本，通过git reflog可以查看所有操作记录，最开始的七位字符就是版本号
  $ git reset --hard 版本号
  ```
  
  **当版本回退时，被git管理的文件夹中，暂存区会被清空且打开本地文件会直接回退至指定版本**，通过reset指令回退版本后，通过git log打印时，就只能查看指定版本以前的提交信息，可以通过git reflog查看所有信息
  
  ![image-20241120204106598](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241120204106598.png)
  
  回到指定版本
  
  ![image-20241120204250860](C:\Users\27120\AppData\Roaming\Typora\typora-user-images\image-20241120204250860.png)
  
+ 回退至暂存区（一般只有两种情况）

  > git  reset  --soft HEAD^
  >
  > soft会将回退的版本文件都退至暂存区，可以将工作区文件修改过后提交至暂存区与回退的相同版本文件合并，
  
  + 刚提交的文件中，注释写的并不是很清晰，希望回退至暂存区重新提交，并添加注释
  + 对于某个有bug的文件，为了方式多次提交对于log的污染，修复bug后通过soft将该文件回退至暂存区，将bug修复后，通过add将该文件提交暂存区进行合并后再次提交，再次提交后合并的内容会被看做为一次提交，当版本进行回退时，会将版本直接回退至上一次提交（会越过soft回退被合并的版本）
  
+ 查看所有版本记录git  reflog

  通过该命令可以查看本地执行的所有操作记录

#### 六、分支

+ 为创建副分支初始化一次空提交

  以下操作会在当前分支提交一次没有任何修改的空提交，当一个分支为空时，创建分支的当前分支会直接消失且你无法再次切换至当前分支，故若需要为当前分支创建副分支，需要初始化一次空提交后再创建其他分支

  ```sh
  git commit --allow-empty -m ""
  ```

  

+ 查看分支

  + 仅查看本地分支

    ```sh
    git branch
    ```

  + 仅查看远程分支

    ```sh
    git branch -r
    ```

  + 查看所有分支

    ```sh
    git branch -a
    ```

+ 分支修改

  + 修改当前分支名

    ```sh
    git branch -m <name>
    ```

    
